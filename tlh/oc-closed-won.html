<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TLH Estate Sales ‚Äî By Sale Weekend</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Lato',system-ui,sans-serif;background:#f8f9fa;color:#0D3B66;padding:20px;min-height:100vh}
h1{font-size:1.5rem;font-weight:700;color:#0D3B66;margin-bottom:4px}
.sub{color:#6b7c8f;font-size:.85rem;margin-bottom:20px}
.card{background:#fff;border-radius:12px;padding:24px;box-shadow:0 2px 12px rgba(0,0,0,.06);margin-bottom:20px}
.card h2{font-size:1.1rem;color:#0D3B66;margin-bottom:16px;padding-bottom:8px;border-bottom:2px solid #38B6B2}
.toggle-row{display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap;justify-content:center}
.toggle{padding:8px 20px;border-radius:20px;cursor:pointer;font-size:.85rem;font-weight:600;border:2px solid #e0e5ea;background:#fff;color:#6b7c8f;transition:.2s}
.toggle:hover{border-color:#38B6B2;color:#0D3B66}
.toggle.active-oc{background:#38B6B2;color:#fff;border-color:#38B6B2}
.toggle.active-sd{background:#A47EAF;color:#fff;border-color:#A47EAF}
.toggle.active-la{background:#0D3B66;color:#fff;border-color:#0D3B66}
.toggle.active-all{background:#0D3B66;color:#fff;border-color:#0D3B66}
.chart-area{position:relative;height:360px;margin:16px 0}
.bar-row{display:flex;align-items:flex-end;gap:6px;height:300px;padding:0 4px;border-bottom:2px solid #e0e5ea}
.bar-col{flex:1;display:flex;flex-direction:column;align-items:center}
.bar-val{font-size:.65rem;font-weight:700;color:#0D3B66;margin-bottom:2px}
.bar{width:80%;border-radius:4px 4px 0 0;transition:.3s;cursor:pointer;position:relative}
.bar:hover{filter:brightness(1.1);transform:scaleY(1.03);transform-origin:bottom}
.bar-oc{background:linear-gradient(180deg,#38B6B2,#2a9d99)}
.bar-sd{background:linear-gradient(180deg,#A47EAF,#8e6899)}
.bar-la{background:linear-gradient(180deg,#0D3B66,#0a2d4f)}
.bar-all-oc{background:#38B6B2}.bar-all-sd{background:#A47EAF}.bar-all-la{background:#0D3B66}
.label-row{display:flex;gap:6px;padding:0 4px;margin-top:4px}
.label-col{flex:1;text-align:center;font-size:.6rem;color:#6b7c8f}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;margin:16px 0}
.stat{background:#f0f7f7;border-radius:10px;padding:14px;text-align:center;border:1px solid #e0eded}
.stat-num{font-size:1.6rem;font-weight:700}
.stat-label{font-size:.72rem;color:#6b7c8f;margin-top:2px}
.color-oc{color:#38B6B2}.color-sd{color:#A47EAF}.color-la{color:#0D3B66}.color-gold{color:#d4ac0d}
.legend{display:flex;gap:16px;justify-content:center;margin:12px 0;font-size:.8rem}
.legend-item{display:flex;align-items:center;gap:5px}
.ldot{width:10px;height:10px;border-radius:3px}
.note{background:#f0f7f7;border:1px solid #d1eceb;border-radius:8px;padding:12px 16px;font-size:.82rem;color:#0D3B66;margin:12px 0}
.note strong{color:#38B6B2}
.stack-group{display:flex;flex-direction:column-reverse;width:80%;align-items:stretch}
.stack-seg{border-radius:0;min-height:0;transition:.3s}
.stack-seg:last-child{border-radius:4px 4px 0 0}
</style>
</head>
<body>

<h1>üè† TLH Estate Sales ‚Äî By Sale Weekend</h1>
<p class="sub">Grouped by <strong>Estate Sale Weekend</strong> field ‚Ä¢ Closed Won ‚Ä¢ Jun 2024 ‚Äî Mar 2026</p>

<div class="toggle-row">
<div class="toggle active-all" data-view="all" onclick="setView('all',this)">All Markets</div>
<div class="toggle" data-view="oc" onclick="setView('oc',this)">üçä Orange County</div>
<div class="toggle" data-view="sd" onclick="setView('sd',this)">üåä San Diego</div>
<div class="toggle" data-view="la" onclick="setView('la',this)">üå¥ Los Angeles</div>
</div>

<div class="card">
<h2 id="chart-title">üìä Monthly Estate Sale Weekends ‚Äî All Markets</h2>
<div class="legend" id="legend">
<div class="legend-item"><div class="ldot" style="background:#38B6B2"></div>OC</div>
<div class="legend-item"><div class="ldot" style="background:#A47EAF"></div>SD</div>
<div class="legend-item"><div class="ldot" style="background:#0D3B66"></div>LA</div>
</div>
<div class="chart-area">
<div class="bar-row" id="bars"></div>
</div>
<div class="label-row" id="labels"></div>
</div>

<div class="stats-grid" id="stats"></div>

<div class="note" id="insight"></div>

<div class="card" id="detail-card" style="display:none">
<h2 id="detail-title">üìà Monthly Detail</h2>
<table id="detail-table" style="width:100%;border-collapse:collapse;font-size:.82rem">
</table>
</div>

<script>
const data = [
{"m":"2024-06","oc":2,"sd":7,"la":0},{"m":"2024-07","oc":1,"sd":7,"la":0},
{"m":"2024-08","oc":4,"sd":8,"la":0},{"m":"2024-09","oc":1,"sd":11,"la":0},
{"m":"2024-10","oc":2,"sd":10,"la":1},{"m":"2024-11","oc":2,"sd":9,"la":0},
{"m":"2024-12","oc":3,"sd":8,"la":1},{"m":"2025-01","oc":2,"sd":11,"la":2},
{"m":"2025-02","oc":4,"sd":9,"la":0},{"m":"2025-03","oc":3,"sd":8,"la":1},
{"m":"2025-04","oc":2,"sd":11,"la":2},{"m":"2025-05","oc":4,"sd":11,"la":0},
{"m":"2025-06","oc":4,"sd":11,"la":0},{"m":"2025-07","oc":3,"sd":12,"la":1},
{"m":"2025-08","oc":6,"sd":15,"la":2},{"m":"2025-09","oc":7,"sd":13,"la":0},
{"m":"2025-10","oc":5,"sd":12,"la":2},{"m":"2025-11","oc":2,"sd":11,"la":1},
{"m":"2025-12","oc":0,"sd":7,"la":5},{"m":"2026-01","oc":1,"sd":9,"la":4},
{"m":"2026-02","oc":1,"sd":8,"la":2},{"m":"2026-03","oc":0,"sd":2,"la":0}
];

const monthNames = {'01':'Jan','02':'Feb','03':'Mar','04':'Apr','05':'May','06':'Jun',
'07':'Jul','08':'Aug','09':'Sep','10':'Oct','11':'Nov','12':'Dec'};

function fmtMonth(m){const[y,mo]=m.split('-');return monthNames[mo]+' '+y.slice(2);}

const totals = {oc:0,sd:0,la:0};
data.forEach(d=>{totals.oc+=d.oc;totals.sd+=d.sd;totals.la+=d.la;});

let currentView = 'all';

function setView(view, btn){
  currentView = view;
  document.querySelectorAll('.toggle').forEach(t=>{
    t.className='toggle';
  });
  btn.className = 'toggle active-'+view;
  render();
}

function render(){
  const bars = document.getElementById('bars');
  const labels = document.getElementById('labels');
  const stats = document.getElementById('stats');
  const title = document.getElementById('chart-title');
  const legend = document.getElementById('legend');
  const insight = document.getElementById('insight');
  const detailCard = document.getElementById('detail-card');
  const detailTitle = document.getElementById('detail-title');
  const detailTable = document.getElementById('detail-table');
  
  bars.innerHTML = '';
  labels.innerHTML = '';
  
  const v = currentView;
  let maxVal;
  
  if(v==='all'){
    maxVal = Math.max(...data.map(d=>d.oc+d.sd+d.la));
    title.textContent = 'üìä Monthly Estate Sale Weekends ‚Äî All Markets';
    legend.style.display = 'flex';
  } else {
    maxVal = Math.max(...data.map(d=>d[v]));
    const names = {oc:'üçä Orange County',sd:'üåä San Diego',la:'üå¥ Los Angeles'};
    title.textContent = 'üìä Monthly Estate Sale Weekends ‚Äî '+names[v];
    legend.style.display = 'none';
  }
  
  if(maxVal===0) maxVal=1;
  
  data.forEach(d=>{
    const col = document.createElement('div');
    col.className = 'bar-col';
    
    if(v==='all'){
      const total = d.oc+d.sd+d.la;
      col.innerHTML = `<div class="bar-val">${total}</div>
        <div class="stack-group">
          ${d.oc>0?`<div class="stack-seg bar-all-oc" style="height:${(d.oc/maxVal)*260}px" title="OC: ${d.oc}"></div>`:''}
          ${d.sd>0?`<div class="stack-seg bar-all-sd" style="height:${(d.sd/maxVal)*260}px" title="SD: ${d.sd}"></div>`:''}
          ${d.la>0?`<div class="stack-seg bar-all-la" style="height:${(d.la/maxVal)*260}px" title="LA: ${d.la}"></div>`:''}
        </div>`;
    } else {
      const val = d[v];
      const cls = 'bar-'+v;
      col.innerHTML = `<div class="bar-val">${val}</div>
        <div class="bar ${cls}" style="height:${val>0?(val/maxVal)*260:0}px" title="${val} sales"></div>`;
    }
    bars.appendChild(col);
    
    const lbl = document.createElement('div');
    lbl.className = 'label-col';
    lbl.textContent = fmtMonth(d.m);
    labels.appendChild(lbl);
  });
  
  // Stats
  if(v==='all'){
    stats.innerHTML = `
      <div class="stat"><div class="stat-num color-oc">${totals.oc}</div><div class="stat-label">OC Total</div></div>
      <div class="stat"><div class="stat-num color-sd">${totals.sd}</div><div class="stat-label">SD Total</div></div>
      <div class="stat"><div class="stat-num color-la">${totals.la}</div><div class="stat-label">LA Total</div></div>
      <div class="stat"><div class="stat-num color-gold">${totals.oc+totals.sd+totals.la}</div><div class="stat-label">All Markets</div></div>`;
    insight.innerHTML = `<strong>üìà Key insight:</strong> SD dominates at ${totals.sd} sales (${Math.round(totals.sd/(totals.oc+totals.sd+totals.la)*100)}% of total). OC is ${totals.oc} sales (${Math.round(totals.oc/(totals.oc+totals.sd+totals.la)*100)}%). LA growing ‚Äî went from 0/mo in mid-2024 to 4-5/mo in late 2025.`;
  } else {
    const vals = data.map(d=>d[v]);
    const total = vals.reduce((a,b)=>a+b,0);
    const avg = (total/data.length).toFixed(1);
    const max = Math.max(...vals);
    const maxMonth = fmtMonth(data[vals.indexOf(max)].m);
    const names = {oc:'Orange County',sd:'San Diego',la:'Los Angeles'};
    const colors = {oc:'color-oc',sd:'color-sd',la:'color-la'};
    
    // YoY: compare H2 2024 vs H2 2025
    const h2_24 = data.filter(d=>d.m>='2024-06'&&d.m<='2024-12').reduce((a,d)=>a+d[v],0);
    const h2_25 = data.filter(d=>d.m>='2025-06'&&d.m<='2025-12').reduce((a,d)=>a+d[v],0);
    const yoyPct = h2_24>0?Math.round((h2_25-h2_24)/h2_24*100):0;
    const yoySign = yoyPct>=0?'+':'';
    
    stats.innerHTML = `
      <div class="stat"><div class="stat-num ${colors[v]}">${total}</div><div class="stat-label">${names[v]} Total Sales</div></div>
      <div class="stat"><div class="stat-num ${colors[v]}">${avg}</div><div class="stat-label">Monthly Average</div></div>
      <div class="stat"><div class="stat-num ${colors[v]}">${max}</div><div class="stat-label">Peak Month (${maxMonth})</div></div>
      <div class="stat"><div class="stat-num ${yoyPct>=0?'color-oc':'color-la'}">${yoySign}${yoyPct}%</div><div class="stat-label">H2 YoY (Jul-Dec)</div></div>`;
    
    if(v==='oc'){
      insight.innerHTML = `<strong>üìà OC trend:</strong> Aug-Oct 2025 was the hot streak (6‚Üí7‚Üí5 sales). Overall OC averages ${avg} sales/month by sale weekend. H2 2025 vs H2 2024: <strong>${yoySign}${yoyPct}%</strong>. Dec-Jan dips are seasonal.`;
    } else if(v==='sd'){
      insight.innerHTML = `<strong>üìà SD trend:</strong> Consistent performer at ${avg}/month. Aug 2025 peak (15 sales). SD is the engine ‚Äî ${Math.round(totals.sd/(totals.oc+totals.sd+totals.la)*100)}% of all TLH estate sale volume.`;
    } else {
      insight.innerHTML = `<strong>üìà LA trend:</strong> Emerging market. Zero sales in mid-2024, now averaging 2-5/month since Q4 2025. Dec 2025 hit 5 ‚Äî highest ever. LA expansion is working.`;
    }
  }
  
  // Detail table
  detailCard.style.display = 'block';
  detailTitle.textContent = 'üìà Monthly Detail' + (v!=='all'?' ‚Äî '+{oc:'Orange County',sd:'San Diego',la:'Los Angeles'}[v]:'');
  let html = '<tr style="border-bottom:2px solid #e0e5ea">';
  html += '<th style="text-align:left;padding:6px 8px;color:#6b7c8f;font-size:.75rem">Month</th>';
  if(v==='all'||v==='oc') html += '<th style="text-align:right;padding:6px 8px;color:#38B6B2;font-size:.75rem">OC</th>';
  if(v==='all'||v==='sd') html += '<th style="text-align:right;padding:6px 8px;color:#A47EAF;font-size:.75rem">SD</th>';
  if(v==='all'||v==='la') html += '<th style="text-align:right;padding:6px 8px;color:#0D3B66;font-size:.75rem">LA</th>';
  html += '<th style="text-align:right;padding:6px 8px;color:#6b7c8f;font-size:.75rem">Total</th></tr>';
  
  data.forEach(d=>{
    const t = v==='all'?(d.oc+d.sd+d.la):d[v];
    html += `<tr style="border-bottom:1px solid #f0f2f5">`;
    html += `<td style="padding:5px 8px;font-size:.8rem">${fmtMonth(d.m)}</td>`;
    if(v==='all'||v==='oc') html += `<td style="text-align:right;padding:5px 8px;font-weight:${d.oc>=5?'700':'400'};color:${d.oc>=5?'#38B6B2':'#0D3B66'}">${d.oc}</td>`;
    if(v==='all'||v==='sd') html += `<td style="text-align:right;padding:5px 8px;font-weight:${d.sd>=12?'700':'400'};color:${d.sd>=12?'#A47EAF':'#0D3B66'}">${d.sd}</td>`;
    if(v==='all'||v==='la') html += `<td style="text-align:right;padding:5px 8px;font-weight:${d.la>=4?'700':'400'};color:${d.la>=4?'#0D3B66':'#0D3B66'}">${d.la}</td>`;
    html += `<td style="text-align:right;padding:5px 8px;font-weight:700">${t}</td></tr>`;
  });
  detailTable.innerHTML = html;
}

render();
</script>
</body>
</html>
