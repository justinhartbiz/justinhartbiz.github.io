<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mycelial Networks | Horizon Expander</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        :root {
            --void-black: #030305;
            --horizon-gold: #FFD28E;
            --horizon-red: #D66D50;
            --telemetry-blue: #7F9CBB;
        }
        body {
            background-color: var(--void-black);
            background-image: 
                radial-gradient(white, rgba(255,255,255,.2) 2px, transparent 2px),
                radial-gradient(white, rgba(255,255,255,.15) 1px, transparent 1px);
            background-size: 50px 50px, 30px 30px;
            background-position: 0 0, 15px 15px;
            color: white;
            font-family: 'Playfair Display', serif;
        }
        .mono {
            font-family: 'JetBrains Mono', monospace;
        }
        .glass-panel {
            background: rgba(10, 10, 15, 0.75);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }
        h1, h2, h3 {
            color: var(--horizon-gold);
        }
        .telemetry {
            color: var(--telemetry-blue);
        }
        .horizon-red {
            color: var(--horizon-red);
        }
        .sparkle {
            position: absolute;
            width: 3px;
            height: 3px;
            background-color: white;
            border-radius: 50%;
            animation: twinkle 4s infinite;
            opacity: 0;
        }
        @keyframes twinkle {
            0% { opacity: 0; }
            50% { opacity: 0.8; }
            100% { opacity: 0; }
        }
        #mycelium-network {
            width: 100%;
            height: 500px;
            position: relative;
        }
        #mycelium-network svg {
            width: 100%;
            height: 100%;
        }
        .node-halo {
            animation: pulse 3s infinite alternate;
        }
        @keyframes pulse {
            0% { opacity: 0.3; }
            100% { opacity: 0.7; }
        }
        .forest-section {
            cursor: pointer;
            transition: opacity 0.3s;
        }
        .forest-section:hover {
            opacity: 0.8;
        }
        .forest-section.active {
            stroke: var(--horizon-gold);
            stroke-width: 2px;
        }
        #nutrient-slider-container {
            width: 100%;
            padding: 10px 0;
        }
        .slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 10px;
            background: rgba(127, 156, 187, 0.3);
            outline: none;
            border-radius: 5px;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--horizon-gold);
            cursor: pointer;
        }
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--horizon-gold);
            cursor: pointer;
        }
        #mycelium-timer {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
        }
        .link-pulse {
            stroke-dasharray: 5;
            animation: dash 30s linear infinite;
        }
        @keyframes dash {
            to {
                stroke-dashoffset: 1000;
            }
        }
        .mycotoxin {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--horizon-red);
            border-radius: 50%;
            animation: float 15s infinite ease-in-out;
            opacity: 0.7;
        }
        @keyframes float {
            0%, 100% { transform: translateY(-5px) translateX(0); }
            50% { transform: translateY(5px) translateX(5px); }
        }
    </style>
</head>
<body class="min-h-screen">
    <div id="stars-container" class="fixed w-full h-full top-0 left-0 -z-10"></div>

    <header class="container mx-auto py-8 px-4">
        <div class="flex items-center mb-8">
            <a href="../index.html" class="flex items-center text-white hover:text-horizon-gold transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                <span class="mono text-sm">RETURN TO MISSION CONTROL</span>
            </a>
        </div>
        <div class="glass-panel p-6 relative overflow-hidden">
            <div class="absolute top-0 right-0 p-4 mono text-xs opacity-50 telemetry">
                EXPEDITION 02 // UNDERGROUND INTELLIGENCE
            </div>
            <h1 class="text-4xl md:text-5xl font-bold mb-2">MYCELIAL NETWORKS</h1>
            <p class="mono telemetry text-xl mb-4">THE INTERNET OF NATURE</p>
            <p class="max-w-3xl text-lg mb-6">Beneath the forest floor lies an invisible network of fungal threads called mycelium, forming vast communication systems that challenge our understanding of intelligence, cooperation, and consciousness. This hidden network connects plants, transfers nutrients, distributes information, and may even possess a primitive form of intelligence.</p>
            <div class="flex items-center">
                <div class="h-4 w-4 rounded-full bg-horizon-red animate-pulse mr-3"></div>
                <p class="mono text-sm">ACTIVE EXPLORATION / UNDERGROUND TRANSMISSION</p>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 pb-16">
        <!-- Introduction to Mycelium -->
        <div class="glass-panel p-6 mb-8">
            <h2 class="text-2xl font-semibold mb-4">THE FUNGAL INTERNET</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div>
                    <h3 class="text-xl font-semibold mb-3 telemetry">WHAT IS MYCELIUM?</h3>
                    <p class="mb-4">Mycelium is the vegetative part of a fungus, consisting of a mass of branching, thread-like structures (hyphae) that can extend for kilometers underground. It forms the largest living organisms on Earth, with a single mycelium network potentially spanning thousands of acres.</p>
                    <p>These vast networks connect to plant roots, creating symbiotic relationships called mycorrhizal associations, where fungi help plants access water and nutrients in exchange for carbohydrates produced through photosynthesis.</p>
                </div>
                <div>
                    <h3 class="text-xl font-semibold mb-3 telemetry">COMMUNICATION NETWORK</h3>
                    <p class="mb-4">Scientists have discovered that mycelial networks function like nature's internet, allowing plants to share resources and information. When one tree is attacked by insects, it can send warning signals through the mycelium to neighboring trees, which then boost their chemical defenses.</p>
                    <p>These networks also redistribute resources from stronger plants to weaker ones, creating a cooperative ecosystem where individual organisms support the health of the entire community.</p>
                </div>
                <div>
                    <h3 class="text-xl font-semibold mb-3 telemetry">FUNGAL INTELLIGENCE</h3>
                    <p class="mb-4">Mycelial networks demonstrate surprising problem-solving abilities. They can find the shortest path through mazes, optimize resource distribution, and even "remember" and avoid harmful stimuli they've encountered before.</p>
                    <p>Some researchers suggest these networks might possess a form of distributed intelligence—a decentralized form of cognition that emerges from the connections and interactions within the network rather than from a centralized brain.</p>
                </div>
            </div>
        </div>

        <!-- Interactive Mycelium Network Simulation -->
        <div class="glass-panel p-6 mb-8">
            <h2 class="text-2xl font-semibold mb-4">INTERACTIVE MYCELIUM NETWORK</h2>
            <p class="mb-6">Witness the dynamic growth and communication patterns of a mycelium network. Observe how resources flow through the system, how different parts connect, and how information transfers across this living internet.</p>
            
            <div id="mycelium-simulation-container" class="relative">
                <div id="mycelium-network" class="border border-telemetry-blue border-opacity-30 rounded-lg mb-4"></div>
                
                <div class="flex flex-wrap md:flex-nowrap gap-4 mb-6">
                    <div class="w-full md:w-1/2 bg-black bg-opacity-30 p-4 rounded-lg">
                        <h3 class="text-telemetry-blue font-mono text-lg mb-2">NETWORK CONTROLS</h3>
                        <div class="mb-4">
                            <label class="block mono text-sm mb-2 telemetry">NUTRIENT AVAILABILITY</label>
                            <div id="nutrient-slider-container">
                                <input type="range" min="10" max="100" value="50" class="slider" id="nutrient-slider">
                                <div class="flex justify-between mt-1 mono text-xs">
                                    <span>LOW</span>
                                    <span>HIGH</span>
                                </div>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="block mono text-sm mb-2 telemetry">ENVIRONMENTAL STRESS</label>
                            <select id="stress-selector" class="bg-black bg-opacity-50 border border-telemetry-blue rounded w-full p-2 text-white">
                                <option value="none">None - Optimal Conditions</option>
                                <option value="drought">Drought - Limited Water</option>
                                <option value="pathogen">Pathogen Attack - One Node</option>
                                <option value="logging">Logging - Network Disruption</option>
                            </select>
                        </div>
                        <div class="flex gap-4 mt-6">
                            <button id="start-simulation" class="bg-horizon-gold text-void-black font-bold py-2 px-4 rounded">START SIMULATION</button>
                            <button id="reset-simulation" class="bg-transparent border border-telemetry-blue text-white font-bold py-2 px-4 rounded">RESET</button>
                        </div>
                    </div>
                    
                    <div class="w-full md:w-1/2 bg-black bg-opacity-30 p-4 rounded-lg">
                        <h3 class="text-telemetry-blue font-mono text-lg mb-2">NETWORK TELEMETRY</h3>
                        <div class="flex flex-col h-full justify-between">
                            <div>
                                <div class="flex justify-between mb-2">
                                    <span class="mono text-sm">Network Size:</span>
                                    <span id="network-size" class="mono text-sm">0 nodes</span>
                                </div>
                                <div class="flex justify-between mb-2">
                                    <span class="mono text-sm">Resource Transfer:</span>
                                    <span id="resource-transfer" class="mono text-sm">0 units/cycle</span>
                                </div>
                                <div class="flex justify-between mb-2">
                                    <span class="mono text-sm">Network Efficiency:</span>
                                    <span id="network-efficiency" class="mono text-sm">0%</span>
                                </div>
                                <div class="flex justify-between mb-2">
                                    <span class="mono text-sm">Time Elapsed:</span>
                                    <span id="mycelium-timer" class="mono text-sm">00:00</span>
                                </div>
                            </div>
                            <div id="network-status" class="mt-4 p-2 rounded bg-black bg-opacity-50">
                                <p class="mono text-xs">Simulation inactive. Click START to begin.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="event-log" class="bg-black bg-opacity-30 p-4 rounded-lg h-32 overflow-y-auto mono text-sm">
                    <p class="text-telemetry-blue">EVENT LOG:</p>
                    <p>• System ready. Waiting for simulation to start...</p>
                </div>
            </div>
        </div>

        <!-- Wood Wide Web - Forest Ecosystem -->
        <div class="glass-panel p-6 mb-8">
            <h2 class="text-2xl font-semibold mb-4">THE WOOD WIDE WEB</h2>
            <p class="mb-6">Explore how mycelial networks connect different species of trees in a forest ecosystem, facilitating resource sharing and communication between diverse plant species.</p>
            
            <div class="relative w-full h-96 border border-telemetry-blue border-opacity-30 rounded-lg mb-6 overflow-hidden" id="forest-ecosystem">
                <svg width="100%" height="100%" id="forest-svg">
                    <!-- Forest sections will be added dynamically -->
                </svg>
                <div id="forest-tooltip" class="absolute hidden bg-black bg-opacity-90 p-2 rounded pointer-events-none mono text-xs"></div>
            </div>
            
            <div id="forest-info" class="bg-black bg-opacity-30 p-4 rounded-lg">
                <h3 class="text-telemetry-blue font-mono text-lg mb-2">FOREST ECOSYSTEM ANALYSIS</h3>
                <p>Click on different forest sections to understand how trees connect through underground mycelial networks and the fascinating dynamics of resource sharing in what scientists call "the Wood Wide Web."</p>
            </div>
        </div>

        <!-- Mycelium Applications -->
        <div class="glass-panel p-6 mb-8">
            <h2 class="text-2xl font-semibold mb-4">MYCOTECHNOLOGY APPLICATIONS</h2>
            <p class="mb-4">The study of mycelial networks has led to revolutionary applications across various fields:</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div class="bg-opacity-20 bg-black p-4 rounded-lg border border-telemetry-blue h-full">
                    <h3 class="text-telemetry-blue font-mono text-lg mb-2">BIOREMEDIATION</h3>
                    <p>Mycelium can break down contaminants in soil and water, including oil spills, pesticides, and industrial toxins. This process, called mycoremediation, uses fungi's natural decomposing abilities to clean polluted environments.</p>
                    <button class="mt-4 text-horizon-gold hover:underline view-application" data-app="bioremediation">View Case Study →</button>
                </div>
                <div class="bg-opacity-20 bg-black p-4 rounded-lg border border-telemetry-blue h-full">
                    <h3 class="text-telemetry-blue font-mono text-lg mb-2">SUSTAINABLE MATERIALS</h3>
                    <p>Mycelium-based materials are being used to create biodegradable packaging, building materials, textiles, and even leather alternatives. These sustainable materials decompose naturally at the end of their lifecycle.</p>
                    <button class="mt-4 text-horizon-gold hover:underline view-application" data-app="materials">View Examples →</button>
                </div>
                <div class="bg-opacity-20 bg-black p-4 rounded-lg border border-telemetry-blue h-full">
                    <h3 class="text-telemetry-blue font-mono text-lg mb-2">MEDICAL INNOVATIONS</h3>
                    <p>Fungal compounds are being researched for antibacterial, antiviral, and anticancer properties. Some fungi produce compounds that can modulate the immune system or target specific pathogens.</p>
                    <button class="mt-4 text-horizon-gold hover:underline view-application" data-app="medical">Explore Research →</button>
                </div>
            </div>
            
            <div id="application-detail" class="hidden mt-6 bg-black bg-opacity-30 p-4 rounded-lg">
                <!-- Content will be dynamically updated based on selection -->
            </div>
        </div>

        <!-- Network Intelligence -->
        <div class="glass-panel p-6 mb-8">
            <h2 class="text-2xl font-semibold mb-4">DISTRIBUTED INTELLIGENCE</h2>
            <p class="mb-6">Test the problem-solving abilities of mycelium networks in this interactive maze experiment, inspired by real scientific research that demonstrated fungal intelligence.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-black bg-opacity-30 p-4 rounded-lg" id="maze-container">
                    <h3 class="text-telemetry-blue font-mono text-lg mb-2">MYCELIUM MAZE EXPERIMENT</h3>
                    <p class="mb-4">Scientists placed food sources at the entrance and exit of a maze, then observed how slime molds (a fungus-like organism with similar network properties to mycelium) found the shortest path between them.</p>
                    
                    <div class="w-full h-64 relative border border-telemetry-blue border-opacity-30 rounded-lg mb-4" id="maze-experiment">
                        <!-- Maze will be generated here -->
                    </div>
                    
                    <div class="flex gap-4">
                        <button id="start-maze" class="bg-horizon-gold text-void-black font-bold py-2 px-4 rounded">START EXPERIMENT</button>
                        <button id="new-maze" class="bg-transparent border border-telemetry-blue text-white font-bold py-2 px-4 rounded">NEW MAZE</button>
                    </div>
                </div>
                
                <div class="bg-black bg-opacity-30 p-4 rounded-lg">
                    <h3 class="text-telemetry-blue font-mono text-lg mb-2">ANALYSIS & IMPLICATIONS</h3>
                    <div id="maze-analysis">
                        <p>The maze experiment demonstrates how fungal networks can solve complex spatial problems without a centralized brain. As the mycelium explores the maze, it initially spreads in all directions, but eventually optimizes its growth to form the most efficient path between food sources.</p>
                        <p class="mt-3">This optimization process mimics algorithms used in computing and transportation networks, suggesting that natural systems evolved efficient network designs long before human technology.</p>
                        <p class="mt-3">Consider how these distributed decision-making systems compare to centralized ones like the human brain. Each has advantages in different contexts.</p>
                    </div>
                    <div class="mt-4 p-2 rounded bg-black bg-opacity-50" id="maze-stats">
                        <div class="flex justify-between mb-1">
                            <span class="mono text-xs">Initial Exploration:</span>
                            <span class="mono text-xs" id="exploration-stat">-</span>
                        </div>
                        <div class="flex justify-between mb-1">
                            <span class="mono text-xs">Solution Time:</span>
                            <span class="mono text-xs" id="solution-time">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="mono text-xs">Path Efficiency:</span>
                            <span class="mono text-xs" id="path-efficiency">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Knowledge Check -->
        <div class="glass-panel p-6">
            <h2 class="text-2xl font-semibold mb-4">KNOWLEDGE ASSESSMENT</h2>
            <p class="mb-4">Test your understanding of mycelial networks with this quick quiz:</p>
            
            <div id="quiz-container">
                <div id="question-1" class="mb-6">
                    <p class="mono text-telemetry-blue mb-2">QUESTION 01</p>
                    <p class="font-semibold mb-3">What is the primary function of mycorrhizal associations between fungi and plants?</p>
                    <div class="space-y-2">
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q1" value="a" class="mr-2">
                            <span>Protecting plants from insect attacks</span>
                        </label>
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q1" value="b" class="mr-2">
                            <span>Exchanging nutrients and resources</span>
                        </label>
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q1" value="c" class="mr-2">
                            <span>Decomposing dead plant matter</span>
                        </label>
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q1" value="d" class="mr-2">
                            <span>Producing oxygen through photosynthesis</span>
                        </label>
                    </div>
                </div>

                <div id="question-2" class="mb-6">
                    <p class="mono text-telemetry-blue mb-2">QUESTION 02</p>
                    <p class="font-semibold mb-3">What term do scientists use to describe the interconnected network of mycelium linking trees in a forest?</p>
                    <div class="space-y-2">
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q2" value="a" class="mr-2">
                            <span>Forest Network Protocol</span>
                        </label>
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q2" value="b" class="mr-2">
                            <span>Fungal Intelligence Grid</span>
                        </label>
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q2" value="c" class="mr-2">
                            <span>Wood Wide Web</span>
                        </label>
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q2" value="d" class="mr-2">
                            <span>Common Mycorrhizal Network</span>
                        </label>
                    </div>
                </div>

                <div id="question-3" class="mb-6">
                    <p class="mono text-telemetry-blue mb-2">QUESTION 03</p>
                    <p class="font-semibold mb-3">Which of these is NOT an application of mycelium technology?</p>
                    <div class="space-y-2">
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q3" value="a" class="mr-2">
                            <span>Biodegradable packaging materials</span>
                        </label>
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q3" value="b" class="mr-2">
                            <span>Environmental cleanup of toxins</span>
                        </label>
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q3" value="c" class="mr-2">
                            <span>Nuclear power generation</span>
                        </label>
                        <label class="block p-2 border border-telemetry-blue rounded cursor-pointer hover:bg-opacity-20 hover:bg-telemetry-blue">
                            <input type="radio" name="q3" value="d" class="mr-2">
                            <span>Medicinal compound production</span>
                        </label>
                    </div>
                </div>

                <button id="check-answers" class="bg-horizon-gold text-void-black font-bold py-2 px-4 rounded">CHECK ANSWERS</button>
                <div id="quiz-results" class="mt-4 hidden"></div>
            </div>
        </div>
    </main>

    <footer class="container mx-auto px-4 pb-8">
        <div class="glass-panel p-4 text-center">
            <p class="mono text-xs opacity-70">HORIZON EXPANDER // EXPEDITION 02: MYCELIAL NETWORKS</p>
            <a href="../index.html" class="inline-block mt-2 text-horizon-gold hover:underline text-sm">Return to Mission Control</a>
        </div>
    </footer>

    <script>
        // Create twinkling stars background
        const starsContainer = document.getElementById('stars-container');
        const numberOfStars = 150;
        
        for (let i = 0; i < numberOfStars; i++) {
            const star = document.createElement('div');
            star.classList.add('sparkle');
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            star.style.animationDelay = `${Math.random() * 4}s`;
            starsContainer.appendChild(star);
        }
        
        // Initialize Lucide icons
        lucide.createIcons();

        // Interactive Mycelium Network Simulation
        const width = document.getElementById('mycelium-network').clientWidth;
        const height = 500;
        const svg = d3.select("#mycelium-network")
            .append("svg")
            .attr("width", width)
            .attr("height", height);
            
        // Define markers for directional flow
        svg.append("defs").append("marker")
            .attr("id", "arrowhead")
            .attr("viewBox", "0 -5 10 10")
            .attr("refX", 15)
            .attr("refY", 0)
            .attr("orient", "auto")
            .attr("markerWidth", 8)
            .attr("markerHeight", 8)
            .attr("xoverflow", "visible")
            .append("svg:path")
            .attr("d", "M 0,-5 L 10,0 L 0,5")
            .attr("fill", "#7F9CBB")
            .attr("stroke", "none");

        let nodes = [];
        let links = [];
        let simulation;
        let timer;
        let seconds = 0;
        let isSimulationRunning = false;
        
        function initializeNetwork() {
            // Clear previous simulation
            svg.selectAll("*").remove();
            nodes = [];
            links = [];
            seconds = 0;
            document.getElementById("mycelium-timer").innerText = "00:00";
            
            // Create initial nodes (roots, hubs, etc.)
            const initialNodes = 5;
            for (let i = 0; i < initialNodes; i++) {
                nodes.push({
                    id: i,
                    x: Math.random() * width,
                    y: Math.random() * height,
                    size: i === 0 ? 15 : 8, // Root node is larger
                    type: i === 0 ? "root" : "hub",
                    health: 100,
                    resources: 50,
                    createdAt: 0
                });
            }
            
            // Create initial connections
            for (let i = 1; i < initialNodes; i++) {
                links.push({
                    source: 0,
                    target: i,
                    value: 1,
                    age: 0
                });
            }
            
            // Connect some hubs to each other
            links.push({
                source: 1,
                target: 2,
                value: 1,
                age: 0
            });
            links.push({
                source: 3,
                target: 4,
                value: 1,
                age: 0
            });
            
            // Initialize force simulation
            simulation = d3.forceSimulation(nodes)
                .force("link", d3.forceLink(links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-50))
                .force("center", d3.forceCenter(width / 2, height / 2))
                .on("tick", ticked);
                
            updateVisualization();
            updateStats();
        }
        
        function ticked() {
            updateVisualization();
        }
        
        function updateVisualization() {
            // Remove all existing elements
            svg.selectAll(".link").remove();
            svg.selectAll(".node").remove();
            svg.selectAll(".node-halo").remove();
            
            // Draw links
            const link = svg.selectAll(".link")
                .data(links)
                .enter().append("line")
                .attr("class", "link")
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y)
                .attr("stroke", d => {
                    const resourceFlow = Math.abs(d.source.resources - d.target.resources);
                    if (resourceFlow > 20) {
                        return "#FFD28E"; // High flow - horizon gold
                    } else if (resourceFlow > 10) {
                        return "#7F9CBB"; // Medium flow - telemetry blue
                    } else {
                        return "rgba(255, 255, 255, 0.3)"; // Low flow - dim white
                    }
                })
                .attr("stroke-width", d => 1 + Math.min(Math.abs(d.source.resources - d.target.resources) / 10, 3))
                .attr("stroke-opacity", 0.8)
                .classed("link-pulse", d => Math.abs(d.source.resources - d.target.resources) > 15);
            
            // Draw node halos
            const nodeHalos = svg.selectAll(".node-halo")
                .data(nodes)
                .enter().append("circle")
                .attr("class", "node-halo")
                .attr("cx", d => d.x)
                .attr("cy", d => d.y)
                .attr("r", d => d.size * 2)
                .attr("fill", d => {
                    if (d.type === "root") return "rgba(255, 210, 142, 0.15)";
                    if (d.health < 50) return "rgba(214, 109, 80, 0.15)";
                    return "rgba(127, 156, 187, 0.15)";
                });
            
            // Draw nodes
            const node = svg.selectAll(".node")
                .data(nodes)
                .enter().append("circle")
                .attr("class", "node")
                .attr("cx", d => d.x)
                .attr("cy", d => d.y)
                .attr("r", d => d.size)
                .attr("fill", d => {
                    if (d.type === "root") return "#FFD28E"; // horizon gold
                    if (d.health < 30) return "#D66D50"; // horizon red
                    return "#7F9CBB"; // telemetry blue
                })
                .attr("stroke", "#030305")
                .attr("stroke-width", 1)
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));
                    
            // Add tooltips
            node.append("title")
                .text(d => `Type: ${d.type}\nHealth: ${d.health}%\nResources: ${d.resources}`);
        }
        
        function dragstarted(event) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            event.subject.fx = event.subject.x;
            event.subject.fy = event.subject.y;
        }
        
        function dragged(event) {
            event.subject.fx = event.x;
            event.subject.fy = event.y;
        }
        
        function dragended(event) {
            if (!event.active) simulation.alphaTarget(0);
            event.subject.fx = null;
            event.subject.fy = null;
        }
        
        function updateStats() {
            document.getElementById("network-size").innerText = `${nodes.length} nodes`;
            
            // Calculate resource transfer
            let totalTransfer = 0;
            links.forEach(link => {
                totalTransfer += Math.abs(link.source.resources - link.target.resources);
            });
            document.getElementById("resource-transfer").innerText = `${Math.round(totalTransfer)} units/cycle`;
            
            // Calculate network efficiency
            const connectedRatio = links.length / (nodes.length * (nodes.length - 1) / 2);
            const efficiency = Math.min(Math.round(connectedRatio * 100), 100);
            document.getElementById("network-efficiency").innerText = `${efficiency}%`;
        }
        
        function updateTimer() {
            seconds++;
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            document.getElementById("mycelium-timer").innerText = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }
        
        function addLogEntry(message) {
            const log = document.getElementById("event-log");
            const entry = document.createElement("p");
            entry.innerHTML = `• ${message}`;
            log.insertBefore(entry, log.childNodes[1]);
            
            // Limit to 10 entries
            if (log.childNodes.length > 11) {
                log.removeChild(log.lastChild);
            }
        }
        
        function growNetwork() {
            // Only grow if simulation is running
            if (!isSimulationRunning) return;
            
            const nutrientLevel = parseInt(document.getElementById("nutrient-slider").value);
            const stressType = document.getElementById("stress-selector").value;
            
            // Add new nodes occasionally
            if (Math.random() < 0.2 * (nutrientLevel / 50)) {
                const sourceNode = nodes[Math.floor(Math.random() * nodes.length)];
                
                // Create new node
                const newNodeId = nodes.length;
                const angle = Math.random() * 2 * Math.PI;
                const distance = 30 + Math.random() * 50;
                
                nodes.push({
                    id: newNodeId,
                    x: sourceNode.x + Math.cos(angle) * distance,
                    y: sourceNode.y + Math.sin(angle) * distance,
                    size: 5 + Math.random() * 5,
                    type: Math.random() < 0.2 ? "hub" : "mycelium",
                    health: 80 + Math.random() * 20,
                    resources: sourceNode.resources * 0.5,
                    createdAt: seconds
                });
                
                // Create link
                links.push({
                    source: sourceNode.id,
                    target: newNodeId,
                    value: 1,
                    age: 0
                });
                
                // Connect to nearby nodes occasionally
                nodes.forEach(node => {
                    if (node.id !== newNodeId && node.id !== sourceNode.id) {
                        const dx = node.x - nodes[newNodeId].x;
                        const dy = node.y - nodes[newNodeId].y;
                        const distance = Math.sqrt(dx*dx + dy*dy);
                        
                        if (distance < 100 && Math.random() < 0.3) {
                            links.push({
                                source: newNodeId,
                                target: node.id,
                                value: 1,
                                age: 0
                            });
                        }
                    }
                });
                
                addLogEntry(`New mycelium node formed at t=${seconds}s`);
                simulation.nodes(nodes);
                simulation.force("link").links(links);
                simulation.alpha(0.3).restart();
            }
            
            // Resource transfer between nodes
            links.forEach(link => {
                const source = link.source;
                const target = link.target;
                
                // Resource flows from high to low
                if (source.resources > target.resources + 5) {
                    const transferAmount = (source.resources - target.resources) * 0.1;
                    source.resources -= transferAmount;
                    target.resources += transferAmount;
                    
                    if (transferAmount > 3 && Math.random() < 0.1) {
                        addLogEntry(`Significant resource transfer: ${source.id} → ${target.id}`);
                    }
                }
                
                link.age += 1;
            });
            
            // Handle environmental stress
            if (stressType !== "none") {
                applyStress(stressType);
            }
            
            // Resource regeneration for nodes
            nodes.forEach(node => {
                // Nodes regenerate resources based on type and nutrient level
                if (node.type === "root") {
                    node.resources += 0.5 * (nutrientLevel / 50);
                } else {
                    node.resources += 0.2 * (nutrientLevel / 50);
                }
                
                // Cap resources
                node.resources = Math.min(node.resources, 100);
                
                // Health changes based on resources
                if (node.resources < 20) {
                    node.health -= 1;
                    if (node.health < 30 && Math.random() < 0.05) {
                        addLogEntry(`Node ${node.id} is showing signs of stress`);
                    }
                } else if (node.health < 100) {
                    node.health += 0.2;
                }
                
                // Node death
                if (node.health <= 0 && nodes.length > 5) {
                    addLogEntry(`Node ${node.id} has died due to resource depletion`);
                    
                    // Remove links connected to this node
                    links = links.filter(l => l.source.id !== node.id && l.target.id !== node.id);
                    
                    // Remove node
                    nodes = nodes.filter(n => n.id !== node.id);
                    
                    simulation.nodes(nodes);
                    simulation.force("link").links(links);
                    simulation.alpha(0.3).restart();
                }
            });
            
            updateVisualization();
            updateStats();
        }
        
        function applyStress(stressType) {
            switch (stressType) {
                case "drought":
                    // Reduce resources across network
                    nodes.forEach(node => {
                        node.resources -= 0.3;
                    });
                    if (seconds % 10 === 0) {
                        addLogEntry("Drought conditions reducing resources across network");
                    }
                    break;
                    
                case "pathogen":
                    // Attack a specific node if one isn't already under attack
                    const unhealthyNodes = nodes.filter(n => n.health < 50);
                    if (unhealthyNodes.length === 0 || Math.random() < 0.05) {
                        const targetNode = nodes[Math.floor(Math.random() * nodes.length)];
                        targetNode.health -= 5;
                        targetNode.resources -= 3;
                        
                        addLogEntry(`Pathogen attacking node ${targetNode.id}`);
                        
                        // Warning signal to connected nodes
                        links.forEach(link => {
                            if (link.source.id === targetNode.id || link.target.id === targetNode.id) {
                                const connectedNode = link.source.id === targetNode.id ? link.target : link.source;
                                
                                // Connected nodes prepare defenses
                                if (connectedNode.resources > 20) {
                                    connectedNode.resources -= 2;
                                    connectedNode.health += 1;
                                }
                            }
                        });
                    }
                    break;
                    
                case "logging":
                    // Randomly remove links to simulate network disruption
                    if (Math.random() < 0.05 && links.length > nodes.length) {
                        const removedLink = links.splice(Math.floor(Math.random() * links.length), 1)[0];
                        addLogEntry(`Network connection severed between nodes ${removedLink.source.id} and ${removedLink.target.id}`);
                        
                        simulation.force("link").links(links);
                        simulation.alpha(0.1).restart();
                    }
                    break;
            }
            
            // Update network status
            const networkStatus = document.getElementById("network-status");
            switch (stressType) {
                case "drought":
                    networkStatus.innerHTML = `<p class="mono text-xs text-horizon-red">DROUGHT STRESS ACTIVE: Network resources declining</p>`;
                    break;
                case "pathogen":
                    networkStatus.innerHTML = `<p class="mono text-xs text-horizon-red">PATHOGEN ATTACK: Defensive signaling activated</p>`;
                    break;
                case "logging":
                    networkStatus.innerHTML = `<p class="mono text-xs text-horizon-red">NETWORK DISRUPTION: Attempting to rebuild connections</p>`;
                    break;
                default:
                    networkStatus.innerHTML = `<p class="mono text-xs">Simulation running. Network stable.</p>`;
            }
        }
        
        // Initialize simulation controls
        document.getElementById("start-simulation").addEventListener("click", function() {
            if (!isSimulationRunning) {
                isSimulationRunning = true;
                this.textContent = "PAUSE SIMULATION";
                
                // Start growth and timer
                growInterval = setInterval(growNetwork, 1000);
                timer = setInterval(updateTimer, 1000);
                
                addLogEntry("Simulation started");
                document.getElementById("network-status").innerHTML = `<p class="mono text-xs">Simulation active. Network growing...</p>`;
            } else {
                isSimulationRunning = false;
                this.textContent = "RESUME SIMULATION";
                
                // Pause growth and timer
                clearInterval(growInterval);
                clearInterval(timer);
                
                addLogEntry("Simulation paused");
                document.getElementById("network-status").innerHTML = `<p class="mono text-xs">Simulation paused. Network stable.</p>`;
            }
        });
        
        document.getElementById("reset-simulation").addEventListener("click", function() {
            // Stop ongoing simulation
            isSimulationRunning = false;
            document.getElementById("start-simulation").textContent = "START SIMULATION";
            clearInterval(growInterval);
            clearInterval(timer);
            
            // Reset simulation
            initializeNetwork();
            addLogEntry("Simulation reset");
            document.getElementById("network-status").innerHTML = `<p class="mono text-xs">Simulation inactive. Click START to begin.</p>`;
        });

        // Forest Ecosystem - The Wood Wide Web
        function initializeForest() {
            const forestSvg = d3.select("#forest-svg");
            const forestWidth = document.getElementById("forest-svg").clientWidth;
            const forestHeight = document.getElementById("forest-svg").clientHeight;
            
            // Define forest sections (different tree species areas)
            const forestSections = [
                { id: "oak", name: "Oak Forest", x: 50, y: 50, width: 200, height: 150, color: "#7F9CBB", trees: 12, 
                  desc: "Oak trees form extensive mycorrhizal networks, connecting with hundreds of fungal species. They are 'hub trees' that can support younger trees with nutrients during times of stress." },
                { id: "pine", name: "Pine Grove", x: 300, y: 80, width: 180, height: 130, color: "#5A7A9E", trees: 8, 
                  desc: "Pine trees primarily form ectomycorrhizal associations, where the fungus creates a sheath around the root. They depend heavily on these connections in nutrient-poor soils." },
                { id: "birch", name: "Birch Stand", x: 150, y: 230, width: 150, height: 120, color: "#6B8EAF", trees: 6, 
                  desc: "Birch trees are early colonizers that help establish mycelial networks in recovering areas. They share carbon with nearby conifers through mycorrhizal bridges." },
                { id: "maple", name: "Maple Cluster", x: 400, y: 250, width: 170, height: 100, color: "#4D6C8C", trees: 5, 
                  desc: "Maple trees form arbuscular mycorrhizal relationships, where fungal structures penetrate root cells. They exchange carbon for phosphorus through these intimate connections." },
                { id: "old_growth", name: "Old Growth Mix", x: 600, y: 150, width: 250, height: 200, color: "#3A5A7A", trees: 15, 
                  desc: "This diverse old-growth section contains trees of various species and ages. Mother trees with extensive root systems serve as hubs in the network, supporting seedlings and sharing resources across species barriers." }
            ];
            
            // Draw forest sections
            forestSvg.selectAll("rect")
                .data(forestSections)
                .enter()
                .append("rect")
                .attr("x", d => d.x)
                .attr("y", d => d.y)
                .attr("width", d => d.width)
                .attr("height", d => d.height)
                .attr("fill", d => d.color)
                .attr("stroke", "rgba(255, 255, 255, 0.2)")
                .attr("rx", 5)
                .attr("class", "forest-section")
                .attr("data-id", d => d.id)
                .on("mouseover", function(event, d) {
                    const tooltip = document.getElementById("forest-tooltip");
                    tooltip.textContent = d.name;
                    tooltip.style.left = `${event.pageX - document.getElementById("forest-ecosystem").getBoundingClientRect().left + 10}px`;
                    tooltip.style.top = `${event.pageY - document.getElementById("forest-ecosystem").getBoundingClientRect().top + 10}px`;
                    tooltip.classList.remove("hidden");
                })
                .on("mouseout", function() {
                    document.getElementById("forest-tooltip").classList.add("hidden");
                })
                .on("click", function(event, d) {
                    // Highlight selected section
                    forestSvg.selectAll("rect").classed("active", false);
                    d3.select(this).classed("active", true);
                    
                    // Update info panel
                    document.getElementById("forest-info").innerHTML = `
                        <h3 class="text-telemetry-blue font-mono text-lg mb-2">${d.name.toUpperCase()}</h3>
                        <p class="mb-2">${d.desc}</p>
                        <div class="grid grid-cols-3 gap-2 mt-4">
                            <div class="bg-black bg-opacity-50 p-2 rounded">
                                <span class="mono text-xs block">Trees</span>
                                <span class="block">${d.trees}</span>
                            </div>
                            <div class="bg-black bg-opacity-50 p-2 rounded">
                                <span class="mono text-xs block">Fungal Species</span>
                                <span class="block">${Math.round(d.trees * 1.5)}</span>
                            </div>
                            <div class="bg-black bg-opacity-50 p-2 rounded">
                                <span class="mono text-xs block">Network Connections</span>
                                <span class="block">${d.trees * (d.trees - 1)}</span>
                            </div>
                        </div>
                    `;
                    
                    // Clear existing connections
                    forestSvg.selectAll(".forest-connection").remove();
                    
                    // Draw network connections
                    drawForestConnections(d, forestSections);
                });
                
            // Add tree icons to each section
            forestSections.forEach(section => {
                for (let i = 0; i < section.trees; i++) {
                    const x = section.x + Math.random() * (section.width - 20);
                    const y = section.y + Math.random() * (section.height - 20);
                    
                    forestSvg.append("circle")
                        .attr("cx", x + 10)
                        .attr("cy", y + 10)
                        .attr("r", 4)
                        .attr("fill", "#1a2c1a")
                        .attr("data-section", section.id);
                    
                    forestSvg.append("circle")
                        .attr("cx", x + 10)
                        .attr("cy", y + 10)
                        .attr("r", 8)
                        .attr("fill", "rgba(26, 44, 26, 0.5)")
                        .attr("data-section", section.id);
                }
            });
        }
        
        function drawForestConnections(section, allSections) {
            const forestSvg = d3.select("#forest-svg");
            
            // Get trees in this section
            const trees = forestSvg.selectAll("circle[data-section='" + section.id + "']");
            
            // Connect trees within the section
            const treeData = [];
            trees.each(function() {
                const treeElement = d3.select(this);
                treeData.push({
                    x: parseFloat(treeElement.attr("cx")),
                    y: parseFloat(treeElement.attr("cy")),
                    section: section.id
                });
            });
            
            // Create connections
            treeData.forEach((tree, i) => {
                for (let j = i + 1; j < treeData.length; j++) {
                    if (Math.random() < 0.7) { // Not all trees connect directly
                        forestSvg.append("line")
                            .attr("class", "forest-connection")
                            .attr("x1", tree.x)
                            .attr("y1", tree.y)
                            .attr("x2", treeData[j].x)
                            .attr("y2", treeData[j].y)
                            .attr("stroke", "rgba(255, 210, 142, 0.4)")
                            .attr("stroke-width", 1)
                            .attr("stroke-dasharray", "3,3");
                    }
                }
            });
            
            // Connect to other sections if it's old growth (the hub)
            if (section.id === "old_growth") {
                allSections.forEach(otherSection => {
                    if (otherSection.id !== section.id) {
                        // Find a random tree in each section
                        const hubTree = treeData[Math.floor(Math.random() * treeData.length)];
                        
                        const otherTrees = [];
                        forestSvg.selectAll("circle[data-section='" + otherSection.id + "']").each(function() {
                            const treeElement = d3.select(this);
                            otherTrees.push({
                                x: parseFloat(treeElement.attr("cx")),
                                y: parseFloat(treeElement.attr("cy")),
                                section: otherSection.id
                            });
                        });
                        
                        if (otherTrees.length > 0) {
                            const targetTree = otherTrees[Math.floor(Math.random() * otherTrees.length)];
                            
                            forestSvg.append("line")
                                .attr("class", "forest-connection")
                                .attr("x1", hubTree.x)
                                .attr("y1", hubTree.y)
                                .attr("x2", targetTree.x)
                                .attr("y2", targetTree.y)
                                .attr("stroke", "rgba(214, 109, 80, 0.6)")
                                .attr("stroke-width", 2)
                                .attr("stroke-dasharray", "5,3");
                        }
                    }
                });
            }
        }
        
        // Mycotechnology Applications
        const applicationDetails = {
            bioremediation: `
                <h3 class="text-telemetry-blue font-mono text-lg mb-2">MYCOREMEDIATION CASE STUDY</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <p class="mb-3">In Sequim Bay, Washington, mycologist Paul Stamets demonstrated how mycelium could break down diesel fuel contamination in soil. The process:</p>
                        <ol class="list-decimal list-inside mb-3 space-y-2">
                            <li>Contaminated soil was placed on a bed of woodchips</li>
                            <li>Oyster mushroom mycelium (Pleurotus ostreatus) was introduced</li>
                            <li>The mycelium colonized the soil within weeks</li>
                            <li>Diesel fuel concentration decreased from 10,000ppm to under 200ppm in 8 weeks</li>
                            <li>The biodegradation attracted insects, which brought birds, creating an entirely new ecosystem</li>
                        </ol>
                        <p>This process works because fungi produce powerful enzymes that can break down complex hydrocarbons, lignin, and other persistent pollutants that other organisms cannot process.</p>
                    </div>
                    <div class="bg-black bg-opacity-50 p-4 rounded-lg relative" id="bioremediation-visual" style="height: 250px;">
                        <!-- Visualization added by JS -->
                    </div>
                </div>
            `,
            materials: `
                <h3 class="text-telemetry-blue font-mono text-lg mb-2">MYCELIUM-BASED MATERIALS</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-black bg-opacity-50 p-4 rounded-lg">
                        <h4 class="text-horizon-gold font-mono text-sm mb-2">PACKAGING</h4>
                        <p>Companies like Ecovative Design grow mycelium packaging that can replace styrofoam. The material is grown in molds using agricultural waste, forming solid structures in days.</p>
                        <div class="mt-3 text-xs mono text-telemetry-blue">
                            <p>✓ Biodegradable in 45 days</p>
                            <p>✓ Fire-resistant</p>
                            <p>✓ Customizable properties</p>
                        </div>
                    </div>
                    <div class="bg-black bg-opacity-50 p-4 rounded-lg">
                        <h4 class="text-horizon-gold font-mono text-sm mb-2">BUILDING MATERIALS</h4>
                        <p>Mycelium bricks and panels provide alternatives to conventional construction materials with excellent thermal and acoustic insulation properties.</p>
                        <div class="mt-3 text-xs mono text-telemetry-blue">
                            <p>✓ Carbon-negative production</p>
                            <p>✓ Structural strength</p>
                            <p>✓ Low embodied energy</p>
                        </div>
                    </div>
                    <div class="bg-black bg-opacity-50 p-4 rounded-lg">
                        <h4 class="text-horizon-gold font-mono text-sm mb-2">TEXTILES & LEATHER</h4>
                        <p>Mycelium leather alternatives like MycoWorks' Reishi™ material provide sustainable options for fashion and upholstery without animal products.</p>
                        <div class="mt-3 text-xs mono text-telemetry-blue">
                            <p>✓ Water-resistant</p>
                            <p>✓ Customizable textures</p>
                            <p>✓ Reduces plastic waste</p>
                        </div>
                    </div>
                </div>
                <div class="mt-4 p-4 bg-black bg-opacity-30 rounded-lg">
                    <h4 class="text-horizon-gold font-mono text-sm mb-2">PRODUCTION PROCESS</h4>
                    <ol class="list-decimal list-inside space-y-1 mb-3">
                        <li>Mix agricultural waste substrate (sawdust, hemp, etc.)</li>
                        <li>Inoculate with mycelium culture</li>
                        <li>Place in mold of desired shape</li>
                        <li>Incubate 5-7 days while mycelium colonizes substrate</li>
                        <li>Remove from mold and dehydrate to stop growth</li>
                        <li>Optional: Apply natural treatments for water resistance</li>
                    </ol>
                    <p class="text-sm">This process requires 12x less energy than plastic production and creates zero waste.</p>
                </div>
            `,
            medical: `
                <h3 class="text-telemetry-blue font-mono text-lg mb-2">MEDICINAL MYCELIUM RESEARCH</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <p class="mb-3">Fungi produce thousands of bioactive compounds that are being studied for medical applications:</p>
                        
                        <h4 class="text-horizon-gold font-mono text-sm mt-4 mb-2">ANTIMICROBIAL COMPOUNDS</h4>
                        <p class="mb-2">The first antibiotics (penicillin) came from fungi, and researchers are finding new antimicrobial compounds effective against resistant bacteria.</p>
                        <p class="text-sm mono">Research focus: Ganoderma, Fomitopsis, Inonotus</p>
                        
                        <h4 class="text-horizon-gold font-mono text-sm mt-4 mb-2">IMMUNOMODULATION</h4>
                        <p class="mb-2">Beta-glucans and other fungal polysaccharides can modulate immune system function, potentially helping with autoimmune conditions and enhancing cancer treatment.</p>
                        <p class="text-sm mono">Research focus: Turkey Tail, Lion's Mane, Reishi</p>
                        
                        <h4 class="text-horizon-gold font-mono text-sm mt-4 mb-2">NEUROLOGICAL APPLICATIONS</h4>
                        <p class="mb-2">Compounds from certain fungi promote nerve growth factor production and may help with neurodegenerative conditions like Alzheimer's and Parkinson's.</p>
                        <p class="text-sm mono">Research focus: Lion's Mane, Cordyceps, Reishi</p>
                    </div>
                    <div class="bg-black bg-opacity-30 p-4 rounded-lg">
                        <h4 class="text-horizon-gold font-mono text-sm mb-3">CURRENT CLINICAL TRIALS</h4>
                        <div class="space-y-3">
                            <div class="p-2 border border-telemetry-blue rounded-lg">
                                <p class="font-bold mb-1">Turkey Tail (Trametes versicolor)</p>
                                <p class="text-sm">Polysaccharide K (PSK) approved as cancer treatment adjuvant in Japan. Multiple trials for breast, colorectal, and gastric cancers.</p>
                                <p class="text-xs mono text-telemetry-blue mt-1">Phase III trials in progress</p>
                            </div>
                            <div class="p-2 border border-telemetry-blue rounded-lg">
                                <p class="font-bold mb-1">Lion's Mane (Hericium erinaceus)</p>
                                <p class="text-sm">Studies on cognitive enhancement and nerve regeneration. Potential applications for dementia and neuropathy.</p>
                                <p class="text-xs mono text-telemetry-blue mt-1">Phase II trials in progress</p>
                            </div>
                            <div class="p-2 border border-telemetry-blue rounded-lg">
                                <p class="font-bold mb-1">Cordyceps militaris</p>
                                <p class="text-sm">Cordycepin being studied for anti-inflammatory and anti-tumor properties. Potential applications for respiratory conditions.</p>
                                <p class="text-xs mono text-telemetry-blue mt-1">Phase I trials in progress</p>
                            </div>
                        </div>
                        <p class="mt-4 text-sm">Most research is in early stages but shows promising results for conditions where conventional medicine has limitations.</p>
                    </div>
                </div>
            `
        };
        
        document.querySelectorAll('.view-application').forEach(button => {
            button.addEventListener('click', function() {
                const appType = this.getAttribute('data-app');
                const detailSection = document.getElementById('application-detail');
                
                detailSection.innerHTML = applicationDetails[appType];
                detailSection.classList.remove('hidden');
                
                // Add visual elements for bioremediation if needed
                if (appType === 'bioremediation') {
                    const container = document.getElementById('bioremediation-visual');
                    
                    // Add soil layers
                    const soilBefore = document.createElement('div');
                    soilBefore.style.position = 'absolute';
                    soilBefore.style.left = '10%';
                    soilBefore.style.top = '10%';
                    soilBefore.style.width = '35%';
                    soilBefore.style.height = '80%';
                    soilBefore.style.backgroundColor = '#3a2919';
                    soilBefore.style.borderRadius = '5px';
                    soilBefore.innerHTML = '<p class="text-center text-xs mono pt-2">Before Treatment</p>';
                    container.appendChild(soilBefore);
                    
                    // Add oil spots to before
                    for (let i = 0; i < 15; i++) {
                        const spot = document.createElement('div');
                        spot.classList.add('mycotoxin');
                        spot.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
                        spot.style.width = '8px';
                        spot.style.height = '8px';
                        spot.style.left = `${Math.random() * 30 + 12}%`;
                        spot.style.top = `${Math.random() * 60 + 20}%`;
                        container.appendChild(spot);
                    }
                    
                    const soilAfter = document.createElement('div');
                    soilAfter.style.position = 'absolute';
                    soilAfter.style.right = '10%';
                    soilAfter.style.top = '10%';
                    soilAfter.style.width = '35%';
                    soilAfter.style.height = '80%';
                    soilAfter.style.backgroundColor = '#5a4a39';
                    soilAfter.style.borderRadius = '5px';
                    soilAfter.innerHTML = '<p class="text-center text-xs mono pt-2">After Treatment</p>';
                    container.appendChild(soilAfter);
                    
                    // Add mycelium to after
                    for (let i = 0; i < 20; i++) {
                        const myc = document.createElement('div');
                        myc.style.position = 'absolute';
                        myc.style.backgroundColor = 'rgba(255, 255, 255, 0.7)';
                        myc.style.width = '2px';
                        myc.style.height = '2px';
                        myc.style.right = `${Math.random() * 30 + 12}%`;
                        myc.style.top = `${Math.random() * 60 + 20}%`;
                        myc.style.borderRadius = '50%';
                        container.appendChild(myc);
                    }
                    
                    // Add arrow
                    const arrow = document.createElement('div');
                    arrow.style.position = 'absolute';
                    arrow.style.left = '45%';
                    arrow.style.top = '40%';
                    arrow.style.width = '10%';
                    arrow.style.height = '20%';
                    arrow.innerHTML = '<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none"><path d="M5 12h14M12 5l7 7-7 7" stroke="#FFD28E" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                    container.appendChild(arrow);
                }
            });
        });
        
        // Maze Experiment for Mycelium Intelligence
        function initializeMaze() {
            const mazeContainer = document.getElementById('maze-experiment');
            mazeContainer.innerHTML = ''; // Clear previous maze
            
            const cellSize = 20;
            const cols = Math.floor(mazeContainer.clientWidth / cellSize);
            const rows = Math.floor(mazeContainer.clientHeight / cellSize);
            
            // Create maze grid
            const maze = document.createElement('div');
            maze.style.display = 'grid';
            maze.style.gridTemplateColumns = `repeat(${cols}, ${cellSize}px)`;
            maze.style.gridTemplateRows = `repeat(${rows}, ${cellSize}px)`;
            maze.style.gap = '0px';
            
            // Create cells
            const cells = [];
            for (let i = 0; i < rows; i++) {
                const row = [];
                for (let j = 0; j < cols; j++) {
                    const cell = document.createElement('div');
                    cell.style.width = `${cellSize}px`;
                    cell.style.height = `${cellSize}px`;
                    cell.style.backgroundColor = 'rgba(0, 0, 0, 0.3)';
                    cell.style.border = '1px solid rgba(127, 156, 187, 0.3)';
                    cell.setAttribute('data-row', i);
                    cell.setAttribute('data-col', j);
                    cell.setAttribute('data-wall', 'true');
                    cell.classList.add('maze-cell');
                    
                    maze.appendChild(cell);
                    row.push({
                        element: cell,
                        isWall: true,
                        isPath: false,
                        isVisited: false,
                        row: i,
                        col: j
                    });
                }
                cells.push(row);
            }
            
            mazeContainer.appendChild(maze);
            
            // Create start and end points
            const startCell = cells[1][1];
            startCell.isWall = false;
            startCell.element.style.backgroundColor = '#FFD28E';
            startCell.element.setAttribute('data-wall', 'false');
            startCell.element.textContent = 'S';
            startCell.element.style.display = 'flex';
            startCell.element.style.alignItems = 'center';
            startCell.element.style.justifyContent = 'center';
            
            const endCell = cells[rows-2][cols-2];
            endCell.isWall = false;
            endCell.element.style.backgroundColor = '#FFD28E';
            endCell.element.setAttribute('data-wall', 'false');
            endCell.element.textContent = 'E';
            endCell.element.style.display = 'flex';
            endCell.element.style.alignItems = 'center';
            endCell.element.style.justifyContent = 'center';
            
            // Generate maze using recursive division
            function generateMaze(cells, startRow, startCol, endRow, endCol, orientation) {
                if (endRow - startRow < 2 || endCol - startCol < 2) {
                    return;
                }
                
                if (orientation === 'horizontal') {
                    // Make horizontal wall
                    const wallRow = Math.floor(Math.random() * (endRow - startRow - 1)) + startRow + 1;
                    const passageCol = Math.floor(Math.random() * (endCol - startCol)) + startCol;
                    
                    for (let j = startCol; j <= endCol; j++) {
                        if (j !== passageCol) {
                            cells[wallRow][j].isWall = true;
                            cells[wallRow][j].element.style.backgroundColor = 'rgba(0, 0, 0, 0.3)';
                            cells[wallRow][j].element.setAttribute('data-wall', 'true');
                        } else {
                            cells[wallRow][j].isWall = false;
                            cells[wallRow][j].element.style.backgroundColor = 'transparent';
                            cells[wallRow][j].element.setAttribute('data-wall', 'false');
                        }
                    }
                    
                    // Recursively divide sub-regions
                    generateMaze(cells, startRow, startCol, wallRow - 1, endCol, chooseOrientation(wallRow - 1 - startRow, endCol - startCol));
                    generateMaze(cells, wallRow + 1, startCol, endRow, endCol, chooseOrientation(endRow - (wallRow + 1), endCol - startCol));
                } else {
                    // Make vertical wall
                    const wallCol = Math.floor(Math.random() * (endCol - startCol - 1)) + startCol + 1;
                    const passageRow = Math.floor(Math.random() * (endRow - startRow)) + startRow;
                    
                    for (let i = startRow; i <= endRow; i++) {
                        if (i !== passageRow) {
                            cells[i][wallCol].isWall = true;
                            cells[i][wallCol].element.style.backgroundColor = 'rgba(0, 0, 0, 0.3)';
                            cells[i][wallCol].element.setAttribute('data-wall', 'true');
                        } else {
                            cells[i][wallCol].isWall = false;
                            cells[i][wallCol].element.style.backgroundColor = 'transparent';
                            cells[i][wallCol].element.setAttribute('data-wall', 'false');
                        }
                    }
                    
                    // Recursively divide sub-regions
                    generateMaze(cells, startRow, startCol, endRow, wallCol - 1, chooseOrientation(endRow - startRow, wallCol - 1 - startCol));
                    generateMaze(cells, startRow, wallCol + 1, endRow, endCol, chooseOrientation(endRow - startRow, endCol - (wallCol + 1)));
                }
            }
            
            function chooseOrientation(width, height) {
                if (width < height) {
                    return 'horizontal';
                } else if (height < width) {
                    return 'vertical';
                } else {
                    return Math.random() < 0.5 ? 'horizontal' : 'vertical';
                }
            }
            
            // Create paths in the maze
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (i > 0 && i < rows-1 && j > 0 && j < cols-1) {
                        cells[i][j].isWall = false;
                        cells[i][j].element.style.backgroundColor = 'transparent';
                        cells[i][j].element.setAttribute('data-wall', 'false');
                    }
                }
            }
            
            generateMaze(cells, 1, 1, rows-2, cols-2, chooseOrientation(cols-2, rows-2));
            
            // Return maze data for simulation
            return {
                cells,
                startCell,
                endCell,
                rows,
                cols
            };
        }
        
        let currentMaze;
        let mazeSimulationRunning = false;
        
        document.getElementById('new-maze').addEventListener('click', function() {
            if (mazeSimulationRunning) return;
            
            currentMaze = initializeMaze();
            
            // Reset stats
            document.getElementById('exploration-stat').textContent = '-';
            document.getElementById('solution-time').textContent = '-';
            document.getElementById('path-efficiency').textContent = '-';
        });
        
        document.getElementById('start-maze').addEventListener('click', function() {
            if (mazeSimulationRunning) return;
            if (!currentMaze) currentMaze = initializeMaze();
            
            mazeSimulationRunning = true;
            const startTime = Date.now();
            
            // Initial exploration phase
            const explorePaths = [];
            const visited = new Set();
            const queue = [{
                row: currentMaze.startCell.row,
                col: currentMaze.startCell.col,
                path: []
            }];
            visited.add(`${currentMaze.startCell.row},${currentMaze.startCell.col}`);
            
            // Breadth-first search for exploration
            function exploreStep() {
                if (queue.length === 0 || explorePaths.length > 0) {
                    findOptimalPath();
                    return;
                }
                
                const { row, col, path } = queue.shift();
                const currentCell = currentMaze.cells[row][col];
                
                // If we found the end
                if (row === currentMaze.endCell.row && col === currentMaze.endCell.col) {
                    explorePaths.push([...path, { row, col }]);
                    findOptimalPath();
                    return;
                }
                
                // Mark as visited in the first phase
                if (!currentCell.isPath && !currentCell.element.textContent) {
                    currentCell.isVisited = true;
                    currentCell.element.style.backgroundColor = 'rgba(127, 156, 187, 0.3)';
                    
                    // Simulate growth
                    setTimeout(() => {
                        // Check each direction
                        const directions = [
                            { r: -1, c: 0 }, // up
                            { r: 1, c: 0 },  // down
                            { r: 0, c: -1 }, // left
                            { r: 0, c: 1 }   // right
                        ];
                        
                        directions.forEach(dir => {
                            const newRow = row + dir.r;
                            const newCol = col + dir.c;
                            
                            // Check if valid move
                            if (
                                newRow >= 0 && newRow < currentMaze.rows &&
                                newCol >= 0 && newCol < currentMaze.cols &&
                                !currentMaze.cells[newRow][newCol].isWall &&
                                !visited.has(`${newRow},${newCol}`)
                            ) {
                                queue.push({
                                    row: newRow,
                                    col: newCol,
                                    path: [...path, { row, col }]
                                });
                                visited.add(`${newRow},${newCol}`);
                            }
                        });
                        
                        // Continue exploration
                        exploreStep();
                    }, 50);
                } else {
                    // Skip already visited cells
                    exploreStep();
                }
            }
            
            // Find the optimal path once exploration is done
            function findOptimalPath() {
                if (explorePaths.length === 0) {
                    document.getElementById('exploration-stat').textContent = `${visited.size} cells`;
                    document.getElementById('solution-time').textContent = 'No solution found';
                    document.getElementById('path-efficiency').textContent = 'N/A';
                    mazeSimulationRunning = false;
                    return;
                }
                
                // Get the shortest path
                const shortestPath = explorePaths.reduce((shortest, current) => 
                    current.length < shortest.length ? current : shortest
                , explorePaths[0]);
                
                // Update stats
                document.getElementById('exploration-stat').textContent = `${visited.size} cells`;
                
                // Visualize optimal path
                let pathIndex = 0;
                function drawPathStep() {
                    if (pathIndex >= shortestPath.length) {
                        const solutionTime = (Date.now() - startTime) / 1000;
                        document.getElementById('solution-time').textContent = `${solutionTime.toFixed(2)}s`;
                        document.getElementById('path-efficiency').textContent = `${Math.round((shortestPath.length / visited.size) * 100)}%`;
                        mazeSimulationRunning = false;
                        return;
                    }
                    
                    const { row, col } = shortestPath[pathIndex];
                    const cell = currentMaze.cells[row][col];
                    
                    if (!cell.element.textContent) {
                        cell.isPath = true;
                        cell.element.style.backgroundColor = 'rgba(255, 210, 142, 0.5)';
                    }
                    
                    pathIndex++;
                    setTimeout(drawPathStep, 100);
                }
                
                setTimeout(drawPathStep, 500);
            }
            
            // Start the exploration
            exploreStep();
        });
        
        // Quiz logic
        const checkBtn = document.getElementById('check-answers');
        const resultsDiv = document.getElementById('quiz-results');
        
        checkBtn.addEventListener('click', () => {
            const q1Answer = document.querySelector('input[name="q1"]:checked')?.value;
            const q2Answer = document.querySelector('input[name="q2"]:checked')?.value;
            const q3Answer = document.querySelector('input[name="q3"]:checked')?.value;
            
            if (!q1Answer || !q2Answer || !q3Answer) {
                resultsDiv.innerHTML = '<p class="text-horizon-red">Please answer all questions.</p>';
                resultsDiv.classList.remove('hidden');
                return;
            }
            
            let correctCount = 0;
            let feedback = '<p class="mono text-telemetry-blue mb-2">ASSESSMENT RESULTS:</p>';
            
            // Check answers
            if (q1Answer === 'b') {
                feedback += '<p>✓ Question 1: Correct! Mycorrhizal associations primarily function to exchange nutrients and resources between fungi and plants.</p>';
                correctCount++;
            } else {
                feedback += '<p>✗ Question 1: Incorrect. The primary function is exchanging nutrients and resources.</p>';
            }
            
            if (q2Answer === 'c') {
                feedback += '<p>✓ Question 2: Correct! "Wood Wide Web" is the term scientists use to describe mycelial networks in forests.</p>';
                correctCount++;
            } else {
                feedback += '<p>✗ Question 2: Incorrect. "Wood Wide Web" is the correct term.</p>';
            }
            
            if (q3Answer === 'c') {
                feedback += '<p>✓ Question 3: Correct! Nuclear power generation is not an application of mycelium technology.</p>';
                correctCount++;
            } else {
                feedback += '<p>✗ Question 3: Incorrect. Nuclear power generation is not a mycelium application.</p>';
            }
            
            feedback += `<p class="mt-4 text-lg ${correctCount === 3 ? 'text-horizon-gold' : 'text-horizon-red'}">Total score: ${correctCount}/3</p>`;
            
            resultsDiv.innerHTML = feedback;
            resultsDiv.classList.remove('hidden');
        });
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize mycelium network
            initializeNetwork();
            
            // Initialize forest ecosystem
            initializeForest();
            
            // Initialize maze
            currentMaze = initializeMaze();
        });
    </script>
</body>
</html>